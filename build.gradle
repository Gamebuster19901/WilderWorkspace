plugins {
    id 'java-gradle-plugin'
	id 'eclipse'
	id 'maven-publish'
}

repositories {
    maven {
        url "https://maven.fabricmc.net"
    }
	mavenCentral()
	mavenLocal()
}

version = workspaceVersion
group = "com.wildermods"
archivesBaseName = "wilderworkspace"

application {
	mainClass = 'com.wildermods.workspace.Main'
}

sourceCompatibility = '17'
targetCompatibility = '17'

dependencies {
	implementation group: 'commons-io', name: 'commons-io', version: commonsIOVersion
	implementation group: 'org.apache.commons', name: 'commons-text', version: commonsTextVersion
	implementation group: 'net.fabricmc', name: 'fabric-fernflower', version: fernFlowerVersion
}

import org.apache.tools.ant.filters.ReplaceTokens

task processSource(type: Sync) {
	from sourceSets.main.java
	inputs.property 'workspaceVersion', workspaceVersion
	
	filter(ReplaceTokens, tokens: [
		workspaceVersion: workspaceVersion
	])
	into "$buildDir/src"
	
}

compileJava {
	source = processSource.outputs
}

publishing {
	publications {
		maven(MavenPublication) {
			groupID = "com.wildermods",
			artifactId = "wilderworkspace",
			version = workspaceVersion
		}
	}
}